{% extends "layout.html" %}{% block content %}
<h2>订单列表</h2>
<form method="post" action="/admin/danger/wipe_orders" class="row" onsubmit="return confirm('⚠️ 危险操作：将删除全部订单映射（不影响 PDF 文件）。确定继续？')">
  <input name="confirm" placeholder="输入 DELETE ALL ORDERS 以确认" style="flex:1">
  <button type="submit" class="danger">危险：清空全部订单映射</button>
</form>
<form method="get" class="row">
  <input name="q" value="{{q or ''}}" placeholder="按订单搜索"><button type="submit">查询</button>
</form>
<form method="post" action="/admin/orders/batch_delete_all" class="row" onsubmit="return confirm('确定批量删除？若未设置搜索条件将删除全部订单。')">
  <input type="hidden" name="q" value="{{q or ''}}"><button type="submit" class="danger">批量删除</button>
</form>
<table class="table">
  <thead><tr><th>#</th><th>订单</th><th>运单</th><th>更新时间</th></tr></thead>
  <tbody>
    {% for r in rows %}
    <tr><td>{{loop.index + (page-1)*page_size}}</td><td>{{r.order_id}}</td><td>{{r.tracking_no}}</td><td>{{r.updated_at}}</td></tr>
    {% endfor %}
  </tbody>
</table>
<div class="pager">
  {% for p in range(1, pages+1) %}
    {% if p==page %}<b>{{p}}</b>{% else %}<a href="?page={{p}}&q={{q or ''}}">{{p}}</a>{% endif %}
  {% endfor %}
</div>
{% endblock %}
